% Copyright 2023 The terCAD team. All rights reserved.
% Use of this content is governed by a CC BY-NC-ND 4.0 license that can be found in the LICENSE file.

\subsection{Anticipating Experience}
\markboth{Optimizing}{Anticipating Experience}

Users have a distinct expectation regarding how the application should behave in general (summarized "know-how"), and 
covering these expectations might be beneficial by asserting that application is aligned with user needs. That approach
is mostly known as User-Centric Design (UCD) \cite{Stil16}. It entails understanding the needs, goals, and pain points 
of the target audience by conducting user research, creating user personas, and gathering feedback. 

We should craft interfaces that resonate with users and fulfill their expectations. Consistency in design elements, 
such as button placement, color schemes, and typography, helps users feel at ease and reduces cognitive load.


\subsubsection{Adding Localizations} \label{locale}

Adapting to various languages and regions makes the application more accessible and inclusive to a global audience (the 
quality of translation significantly impacts \cite{Lomm07}). That includes translating text, adjusting layouts for 
different languages, and incorporating region-specific content or functionalities.

\noindent Localization can be enabled from a configurational \q{pubspec.yaml}-file with an additional declaration in 
\q{l10n.yaml}-file: 

\begin{lstlisting}[language=yaml]
# ./pubspec.yaml
dependencies:
  flutter_localizations:
    sdk: flutter

# ./l10n.yaml
arb-dir: lib/l10n
template-arb-file: app_en.arb
output-localization-file: app_localization.dart
preferred-supported-locales:
  - en
  - be
\end{lstlisting}

\noindent \q{MaterialApp}-widget should be extended by \q{locale}-properties \issue{7}{}:

\begin{lstlisting}
// Autogenerated package from '.arb'-files
import 'package:app_finance/l10n/app_localization.dart';
// Main application builder
Widget build(BuildContext context) => MaterialApp(
  localizationsDelegates: AppLocalizations.localizationsDelegates,
  // List is generated based on the '.arb'-files availability
  supportedLocales: AppLocalizations.supportedLocales,
  // 'AppLocale' extends from 'ValueNotifier', returns 'Locale'
  locale: context.watch<AppLocale>().value,
  // ... other options
);
\end{lstlisting}

\noindent In the context of \q{Apple}-based applications, it's necessary to include a localization section in 
\q{Runner/Info.plist}-files:

\begin{lstlisting}[language=xml]
<dict>
  <key>CFBundleLocalizations</key>
  <array>
    <string>en</string>
    <!-- other languages -->
  </array>
\end{lstlisting}

\noindent Rich text can be stored in \q{assets}-folder as \q{.md}-files and integrated back into an application by using 
\q{flutter\_markdown}-package:

\begin{lstlisting}
FutureBuilder(
  future: DefaultAssetBundle.of(context).loadString(
    './assets/l10n/$fileName.md'
  ),
  builder: (context, AsyncSnapshot<String> snapshot) =>
    snapshot.hasData ? Markdown(data: snapshot.data!) : Container(),
);
\end{lstlisting}

\noindent Localization encompasses more than just translating a text \cite{Hofs03}; it involves adapting content 
(\emph{in Japan it's usual to get information through stories, while in Germany -- it should be complete, clear and 
precise}) and design for different regions and cultures. For instance, consider adjusting the layout by rearranging 
elements from left-to-right to right-to-left (as a reposition of a left-hand navigation bar to the right) for languages 
like Arabic, Hebrew, and Japanese. In Germany, a navigation bar is typically arranged in alphabetical order, whereas 
in most other regions, it is organized based on the priority of usage intensity. In France, the typical orientation is 
centered, meaning that buttons are usually located in the center of the menu bar rather than in a corner.

Asian cultures often lean towards vibrant layouts, emphasizing the importance of contextual relationships between 
elements. In contrast, Western cultures tend to prefer minimalistic and concise designs, typically incorporating a 
limited color palette while placing primary emphasis on key objects or elements.

This contrast stems from the fundamental difference between collectivism and individualism in cultural norms 
\cite{Wall23}. Individualist cultures prioritize autonomy, valuing personal goals highly, whereas collectivist cultures 
emphasize interdependence, prioritizing community goals over personal objectives. This cultural distinction is 
manifested in the design of digital products. For instance, Canadian apps exhibit minimalist design and a lack of social 
features, while Indian apps often incorporate social support functions.

Icons are like visual metaphors representing user actions, and their interpretation can vary significantly across 
different cultures. When using icons for purposes such as indicating currencies, locations, or navigation (as Chinese 
apps don't use hamburger or kebab symbols for the "menu"-button), it's needed to be mindful that symbols may not have 
universal meanings and can be understood differently. Western user interfaces usually highlight a singular call to 
action, whereas Asian user interfaces tend to feature multiple calls to action. Indicating that collective cultures
incorporate a greater number of visual and interactive elements compared to individualist cultures.

Differences in visual identity may be due to differences between masculine cultures, exemplified by the US and Italy, 
and feminine cultures, such as Thailand and the Netherlands. For example, the former group is characterized by 
accelerated presentation of information that facilitates effective decision making, while the latter group emphasizes 
cultivating an emotional connection to the subject matter, which is achieved primarily through the use of infographics
\cite{Wal923}.

Color choices can vary widely, with Europeans favoring colder colors, Latin Americans preferring warmer hues, and Asian 
cultures embracing vibrant and diverse color palettes.

\img{uiux/fb-localized}{Facebook Registation Page Deviations}{img:ui-facebook}

\noindent These details \cite{Rein14} contribute to an improved user experience for diverse audiences, underscoring the 
importance of localization in collectivist regions. Neglecting localization in such areas could result in a higher 
churn rate.

There is an unresolved issue in Flutter: not all locales are supported, even those listed as supported 
(\href{https://api.flutter.dev/flutter/flutter\_localizations/GlobalMaterialLocalizations-class.html}{GlobalMaterialLocalizations-class}), 
such as Chinese [\q{ch}] (see \href{https://github.com/flutter/flutter/issues/138797}{https://github.com/flutter/flutter/issues/138797}). 
To address this problem, a possible solution involves using a fallback delegate that returns true for any locale, 
regardless of its support by the SDK:

\begin{lstlisting}
class FallbackLocalizationDelegate extends LocalizationsDelegate<MaterialLocalizations> {
  @override
  bool isSupported(Locale locale) => true;
  
  @override
  Future<MaterialLocalizations> load(Locale locale) async => const DefaultMaterialLocalizations();

  @override
  bool shouldReload(old) => false;(*@ \stopnumber @*)
}

// main.dart
MaterialApp(
  localizationsDelegates: [
    ...AppLocalizations.localizationsDelegates,
    FallbackLocalizationDelegate(),
  ],
\end{lstlisting}


\subsubsection{Creating Navigational Clarity} 

Asserting user experience involves designing clear and logical navigation paths, minimizing complexity, and ensuring 
that users can seamlessly move through the application's features and content.

There should be a minimal set of actions to achieve the goal. As an example, by showing additional actions by swiping 
on element (\cref{img:u-swipe}). In our case, that helps to access \q{Edit}-form or \q{Delete} item without going 
through the multiple navigation steps. Such behavior can be achieved by the usage of 
\q{flutter\_swipe\_action\_cell}-component as a wrapper of our Widget \issue{206}{}.

The presentation of navigation layers may vary to accommodate different screen resolutions. This adaptation 
ensures that the user experience remains consistent and user-friendly across various devices and screen sizes 
(\cref{img:u-nav}).

\img{uiux/swipe-actions}{Swipe Actions on Cell}{img:u-swipe}

\img{uiux/navigation-bar}{Navigation Bar deviations across multiple screens}{img:u-nav}


\subsubsection{Personalizing Layout}

Tailored content recommendations or customizable settings, enable applications to assert user experience by delivering 
a more individualized and engaging interaction.

Users might expect not only functionality but also the ability to tailor their experience to their liking; and an 
aspect of this customization is the ability to configure layout settings (color schemes \issue{231}{}, font sizes 
\issue{237}{}, and arrangement of content \issue{258}{}). Allowing them to configure these aspects empowers them to 
create an interface that suits their individual needs and aesthetics (\cref{img:u-custom}). This reduces cognitive 
load and makes navigation more intuitive and personalized.

\img{uiux/layout-editor}{Layout Configuration}{img:u-custom}
